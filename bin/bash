# setup-mcp.sh

echo "ğŸš€ MCP Manager - Instalacja i konfiguracja"
echo "=========================================="

# SprawdÅº Docker
if ! command -v docker &> /dev/null; then
    echo "âŒ Docker nie jest zainstalowany. InstalujÄ™..."
    curl -fsSL https://get.docker.com -o get-docker.sh
    sh get-docker.sh
fi

# SprawdÅº Docker Compose
if ! command -v docker-compose &> /dev/null; then
    echo "âŒ Docker Compose nie jest zainstalowany. InstalujÄ™..."
    sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
    sudo chmod +x /usr/local/bin/docker-compose
fi

# Klonuj repozytorium
echo "ğŸ“¦ Pobieram MCP Manager..."
git clone https://github.com/mcp-manager/app.git mcp-manager
cd mcp-manager

# Konfiguracja Å›rodowiska
echo "âš™ï¸ KonfigurujÄ™ Å›rodowisko..."
cp .env.example .env

# Pytaj o usÅ‚ugi do wÅ‚Ä…czenia
echo "ğŸ¯ KtÃ³re usÅ‚ugi chcesz wÅ‚Ä…czyÄ‡?"
echo "1) Podstawowe (Manager + Ollama)"
echo "2) Rozszerzone (+ File, Web, Database)"
echo "3) PeÅ‚ne (Wszystkie usÅ‚ugi)"
read -p "Wybierz opcjÄ™ (1-3): " choice

case $choice in
    1)
        docker-compose up -d mcp-manager ollama postgres redis
        ;;
    2)
        docker-compose up -d mcp-manager ollama postgres redis \
            mcp-filesystem mcp-webscraper mcp-database
        ;;
    3)
        docker-compose -f docker-compose.all-services.yml up -d
        ;;
    *)
        echo "NieprawidÅ‚owa opcja"
        exit 1
        ;;
esac

# Pobierz modele Ollama
echo "ğŸ“¥ Pobieram modele AI..."
docker exec mcp-ollama ollama pull llama3.2
docker exec mcp-ollama ollama pull codellama

# SprawdÅº status
echo "âœ… Sprawdzam status usÅ‚ug..."
docker-compose ps

echo ""
echo "ğŸ‰ Instalacja zakoÅ„czona!"
echo "ğŸ“ Aplikacja dostÄ™pna pod adresem: http://localhost:3000"
echo "ğŸ“Š Monitoring (Grafana): http://localhost:3001"
echo "ğŸ” DomyÅ›lne dane logowania: admin/admin123"
echo ""
echo "ğŸ“š Dokumentacja: https://github.com/mcp-manager/docs"
echo "ğŸ’¬ Wsparcie: https://discord.gg/mcp-manager"